<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>甲骨文-人</title>
<!-- 載入 A-Frame 和 MindAR -->
<script src="https://cdn.jsdelivr.net/npm/aframe@1.4.2/dist/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
</head>
<body>
<!-- A-Frame 場景設定 -->
<a-scene
  mindar-image="imageTargetSrc: /lobby/jiagu-ren.mind; autoStart: true; uiScanning: true;"
  color-space="sRGB"
  renderer="colorManagement: true; physicallyCorrectLights: true"
  vr-mode-ui="enabled: false"
  device-orientation-permission-ui="enabled: false">

  <!-- 載入影片資源 -->
  <a-assets>
    <video id="introVid" src="/jiagu-video/jiagu-ren.mp4" preload="auto" loop muted playsinline crossorigin="anonymous"></video>
  </a-assets>

  <!-- 環境光線 -->
  <a-light type="ambient" intensity="1.5"></a-light>

  <!-- 相機（禁止滑動視角） -->
  <a-camera look-controls="enabled: false"></a-camera>

  <!-- 掃描到圖卡後顯示影片 -->
  <a-entity mindar-image-target="targetIndex: 0">
    <a-video
      id="videoEntity"
      src="#introVid"
      width="1.2"
      height="0.7"
      autoplay="false"
      loop="true"
      material="shader: flat; color: white"
      position="0 0 0.01">
    </a-video>
  </a-entity>

</a-scene>

<!-- 點擊播放 / 暫停的互動邏輯 -->
<script>
window.addEventListener('DOMContentLoaded', () => {
  const video = document.querySelector('#introVid');
  const videoPlane = document.querySelector('#videoEntity');
  const targetEntity = document.querySelector('a-entity[mindar-image-target]');

  // 點擊影片暫停/播放
  videoPlane.addEventListener('click', () => {
    if (video.paused) video.play();
    else video.pause();
  });

  // 確保影片載入完成再播放
  video.addEventListener('loadeddata', () => {
    targetEntity.addEventListener('targetFound', () => {
      video.play().catch(err => console.log('播放失敗', err));
    });
  });

  // 掃描不到時暫停並重置
  targetEntity.addEventListener('targetLost', () => {
    video.pause();
    video.currentTime = 0;
  });
});
</script>

<!-- 右下角返回首頁按鈕 -->
<style>
  #backHomeBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    cursor: pointer;
    z-index: 9999;
  }
</style>

<a href="https://sites.google.com/view/hanzilab" target="_top">
  <img id="backHomeBtn" src="/lobby/LOGO去背.png" style="width: 300px; height: auto;">
</a>

</body>
</html>
